<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>build.lua</title>
    <link rel="stylesheet" type="text/css" href="default.css" />
    <script>document.write('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/'+(matchMedia('(prefers-color-scheme:dark)').matches?'github-dark':'github')+'.min.css"/>')</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
</head>
<body>
<div class="container">
<nav class="sidebar">
<h2>Contents <a href="index.html" class="sidebar-home" title="Home">⌂</a></h2>
<ul id="toc">
<li><a href="#def">Defines</a></li>
<li class="toc-sub"><a href="#def-1">1. Resolve script directory for portable paths</a></li>
<li class="toc-sub"><a href="#def-2">2. Load config from script directory</a></li>
<li class="toc-sub"><a href="#def-3">3. Build markdown.lua flags from config</a></li>
<li><a href="#run">Runners</a></li>
<li class="toc-sub"><a href="#run-1">1. Build pipeline: generate docs and convert to HTML</a></li>
<li class="toc-sub"><a href="#run-2">2. Generate markdown documentation</a></li>
<li class="toc-sub"><a href="#run-3">3. Copy stylesheet and assets to output directory</a></li>
<li class="toc-sub"><a href="#run-4">4. Convert all markdown files to HTML</a></li>
</ul>
</nav>
<main class="content">

<h1>build.lua</h1>

<p><code>~/Desktop/autoodocs/build.lua</code></p>

<p>Build script that runs autoodocs and converts output to HTML</p>

<h2><a id="def"></a>Defines</h2>

<h3><a id="def-1"></a>1. Resolve script directory for portable paths</h3>

<p><code>~/Desktop/autoodocs/build.lua:5</code></p>

<pre><code class="language-lua">local fmt = string.format
local dir = arg[0]:match("^(.-)[^/]*$") or "./"
</code></pre>

<h3><a id="def-2"></a>2. Load config from script directory</h3>

<p><code>~/Desktop/autoodocs/build.lua:9</code></p>

<pre><code class="language-lua">local cfg = { cmd = "lua", scan_dir = ".", out_dir = "docs", stats = true, check = true, repo = "" }
local conf_file = loadfile(dir .. "config.lua")
if conf_file then
    for k, v in pairs(conf_file()) do cfg[k] = v end
end
</code></pre>

<h3><a id="def-3"></a>3. Build markdown.lua flags from config</h3>

<p><code>~/Desktop/autoodocs/build.lua:25</code></p>

<pre><code class="language-lua">local md_flags = ""
if cfg.header then md_flags = md_flags .. fmt("-e %s ", cfg.header) end
if cfg.footer then md_flags = md_flags .. fmt("-f %s ", cfg.footer) end
if cfg.stylesheet then md_flags = md_flags .. fmt("-s %s ", cfg.stylesheet) end
if cfg.inline_style then md_flags = md_flags .. "-l " end
if cfg.favicon then md_flags = md_flags .. fmt("--favicon %s ", cfg.favicon) end
if cfg.timestamp then md_flags = md_flags .. fmt('--timestamp "%s" ', os.date("%Y-%m-%d %H:%M")) end
</code></pre>

<h2><a id="run"></a>Runners</h2>

<h3><a id="run-1"></a>1. Build pipeline: generate docs and convert to HTML</h3>

<p><code>~/Desktop/autoodocs/build.lua:3</code></p>


<h3><a id="run-2"></a>2. Generate markdown documentation</h3>

<p><code>~/Desktop/autoodocs/build.lua:17</code></p>

<p>Flags based on config</p>

<blockquote>
    <p><em>↳ <a href="autoodocs-lua.html#def-4">autoodocs.lua:82</a></em></p>
</blockquote>

<pre><code class="language-lua">local flags = (cfg.stats and "-s " or "") .. (cfg.check and "-c " or "")
local repo = cfg.repo ~= "" and ("-r " .. cfg.repo) or ""
print("Generating markdown...")
os.execute(fmt("%s %sautoodocs.lua %s %s %s%s", cfg.cmd, dir, cfg.scan_dir, cfg.out_dir, flags, repo))
</code></pre>

<h3><a id="run-3"></a>3. Copy stylesheet and assets to output directory</h3>

<p><code>~/Desktop/autoodocs/build.lua:34</code></p>

<p><em>↳ <a href="default-css.html">default.css</a></em></p>

<pre><code class="language-lua">print("Copying assets...")
os.execute(fmt("cp %sdefault.css %s/", dir, cfg.out_dir))
if cfg.stylesheet and cfg.stylesheet ~= "default.css" then
    os.execute(fmt("cp %s %s/", cfg.stylesheet, cfg.out_dir))
end
if cfg.favicon then
    os.execute(fmt("cp %s %s/", cfg.favicon, cfg.out_dir))
end
</code></pre>

<h3><a id="run-4"></a>4. Convert all markdown files to HTML</h3>

<p><code>~/Desktop/autoodocs/build.lua:45</code></p>

<p><em>↳ <a href="markdown-lua.html">markdown.lua</a></em></p>

<pre><code class="language-lua">print("Converting to HTML...")
local pipe = io.popen(fmt("ls %s/*.md 2&gt;/dev/null", cfg.out_dir))
for md in pipe:lines() do
    os.execute(fmt("%s %smarkdown.lua %s%s", cfg.cmd, dir, md_flags, md))
end
pipe:close()
</code></pre>


<div class="build-timestamp">Generated: 2026-02-15 23:06</div>
</main>
</div>
<script>
hljs.highlightAll();
// Hide home icon on index page
if (location.pathname.endsWith('index.html') || location.pathname.endsWith('/')) {
    var home = document.querySelector('.sidebar-home');
    if (home) home.style.display = 'none';
}
// Highlight active section on scroll
var links = document.querySelectorAll('.sidebar a');
var sections = document.querySelectorAll('.content h2, .content h3');
window.addEventListener('scroll', function() {
    var current = '';
    sections.forEach(function(section) {
        var anchor = section.querySelector('a');
        if (anchor && window.scrollY >= section.offsetTop - 100) {
            current = anchor.id;
        }
    });
    links.forEach(function(link) {
        link.classList.remove('active');
        if (link.getAttribute('href') === '#' + current) {
            link.classList.add('active');
        }
    });
});
</script>
</body></html>